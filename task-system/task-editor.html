<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>新增題目 - 白貓工作室</title>
  <link rel="stylesheet" href="../task-system/task-style.css">
</head>
<body>
  <header>
    <h1>新增題目 - 白貓工作室</h1>
    <button onclick="window.location.href='task-center.html'">← 返回派題中心</button>
  </header>

  <main>
    <section class="editor-section">
      <h2>新增題目</h2>

      <label>題目類型：</label>
      <select id="questionType">
        <option value="truefalse">是非題</option>
        <option value="choice">選擇題</option>
        <option value="multichoice">複選題</option>
        <option value="shortanswer">簡答題</option>
        <option value="highschool">高中題</option>
        <option value="image">圖片題</option>
      </select>

      <label>題目內容：</label>
      <textarea id="questionText" rows="4" placeholder="請輸入題目內容..."></textarea>

      <div id="choiceOptions" style="display:none;">
        <label>選項：</label><br>
        <input type="text" id="option1" placeholder="1選項">
        <input type="text" id="option2" placeholder="2選項">
        <input type="text" id="option3" placeholder="3選項">
        <input type="text" id="option4" placeholder="4選項">
      </div>

      <div id="imageUpload" style="display:none;">
        <label>上傳圖片：</label>
        <input type="file" id="questionImage" disabled placeholder="尚未支援圖片上傳">
      </div>

      <label>正確答案：</label>

      <!-- 單選答案 -->
      <select id="correctAnswerSelect" style="display: none;">
        <!-- 內容由JS動態生成 -->
      </select>

      <!-- 簡答題 -->
      <input type="text" id="correctAnswerInput" placeholder="請輸入正確答案" style="display: none;">

      <!-- 複選題 -->
      <div id="multiAnswerCheckboxes" style="display: none;">
        <label><input type="checkbox" value="1"> 1</label>
        <label><input type="checkbox" value="2"> 2</label>
        <label><input type="checkbox" value="3"> 3</label>
        <label><input type="checkbox" value="4"> 4</label>
      </div>

      <button id="saveQuestionBtn">💾 儲存題目</button>
    </section>

    <hr>

    <section class="ai-helper">
      <h2>🔍 AI輔助出題</h2>
      <p>需要靈感？可以利用 ChatGPT 生成指令！</p>

      <label>題型：</label>
      <select id="promptType">
        <option value="truefalse">是非題</option>
        <option value="choice">選擇題</option>
        <option value="multichoice">複選題</option>
        <option value="shortanswer">簡答題</option>
        <option value="highschool">高中題</option>
      </select>

      <label>主題：</label>
      <input type="text" id="promptSubject" placeholder="例如：太陽系、氣候變遷">

      <label>學段：</label>
      <select id="promptLevel">
        <option value="國小中年級">國小中年級</option>
        <option value="國小高年級">國小高年級</option>
        <option value="國中">國中</option>
        <option value="高中">高中</option>
      </select>

      <button onclick="generatePrompt()">🎯 生成指令</button>

      <textarea id="generatedPrompt" rows="4" placeholder="這裡會顯示生成的提示語..."></textarea>
      <button onclick="copyPrompt()">📋 複製指令</button>

      <p><a href="https://chat.openai.com/" target="_blank">➔ 前往 ChatGPT 練習</a></p>
    </section>
  </main>

  <!-- 連到新版 task-editor.js -->
  <script type="module" src="../task-system/task-editor.js"></script>

  <!-- 內建生成指令的小工具 -->
  <script>
    function generatePrompt() {
      const type = document.getElementById('promptType').value;
      const subject = document.getElementById('promptSubject').value;
      const level = document.getElementById('promptLevel').value;

      let prompt = '';
      if (type === 'truefalse') {
        prompt = `請用中文為${level}學生出一題是非題，主題是『${subject}』，並正確標示答案。`;
      } else if (type === 'choice') {
        prompt = `請用中文為${level}學生生成一題四選一的選擇題，主題是『${subject}』，並正確標示答案。`;
      } else if (type === 'multichoice') {
        prompt = `請用中文為${level}學生出一題可以多選的選擇題，主題是『${subject}』，並標記所有正確選項。`;
      } else if (type === 'shortanswer') {
        prompt = `請用中文為${level}學生出一題簡答題，主題是『${subject}』，並附上參考答案。`;
      } else if (type === 'highschool') {
        prompt = `請用中文為${level}學生出一題高中程度的選擇題，主題是『${subject}』，並正確標示答案。`;
      }
      document.getElementById('generatedPrompt').value = prompt;
    }

    function copyPrompt() {
      const textarea = document.getElementById('generatedPrompt');
      textarea.select();
      document.execCommand('copy');
      alert('指令已複製！');
    }
  </script>

</body>
</html>
