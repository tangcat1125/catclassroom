<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å‡ºé¡Œå°ç²¾éˆ - ç™½è²“å·¥ä½œå®¤</title>
  <link rel="stylesheet" href="../task-system/task-style.css">
  <style>
    /* Optional: Style the footer to stick at the bottom */
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    main {
      flex-grow: 1; /* Allow main content to grow */
    }
    footer {
      text-align: center; /* Center the button in the footer */
      padding: 1rem 0;
      margin-top: 2rem; /* Add some space above the footer */
      border-top: 1px solid #eee; /* Optional separator line */
    }
    /* Style for the textarea to indicate it's readonly */
    #generatedInstruction {
        background-color: #f8f8f8;
    }
  </style>
</head>
<body>
  <header>
    <h1>å‡ºé¡Œå°ç²¾éˆ</h1>
    <!-- ç§»é™¤äº†å¤šé¤˜çš„ "ä½¿ç”¨äººå·¥æ™ºæ…§" æŒ‰éˆ• -->
  </header>

  <main>
    <!-- å‡ºé¡Œå°ç²¾éˆæç¤ºå€å¡Š -->
    <section class="wizard-section">
      <h2>é¸æ“‡å­¸ç¨‹ã€ç§‘ç›®ã€å‡ºé¡Œä¸»é¡Œ</h2>

      <form id="wizardForm">
        <label for="wizardCourseLevel">å­¸ç¨‹ï¼š</label>
        <select id="wizardCourseLevel">
          <option value="åœ‹å°ä¸­å¹´ç´š">åœ‹å°ä¸­å¹´ç´š</option>
          <option value="åœ‹å°é«˜å¹´ç´š">åœ‹å°é«˜å¹´ç´š</option>
          <option value="åœ‹ä¸­">åœ‹ä¸­</option>
          <option value="é«˜ä¸­">é«˜ä¸­</option>
        </select><br><br>

        <label for="wizardSubject">ç§‘ç›®ï¼š</label>
        <select id="wizardSubject">
          <option value="åœ‹èª">åœ‹èª</option>
          <option value="æ•¸å­¸">æ•¸å­¸</option>
          <option value="è‡ªç„¶">è‡ªç„¶</option>
          <option value="ç¤¾æœƒ">ç¤¾æœƒ</option>
          <option value="è‹±æ–‡">è‹±æ–‡</option>
        </select><br><br>

        <label for="wizardTopic">å‡ºé¡Œä¸»é¡Œï¼š</label>
        <input type="text" id="wizardTopic" placeholder="ä¾‹å¦‚ï¼šè‡ºç£çš„åœ°å½¢ã€åˆ†æ•¸çš„åŠ æ¸›"><br><br>

        <label for="promptType">é¸æ“‡é¡Œå‹ï¼š</label>
        <select id="promptType">
          <option value="truefalse">æ˜¯éé¡Œ</option>
          <option value="choice">é¸æ“‡é¡Œ</option>
          <option value="multichoice">è¤‡é¸é¡Œ</option>
          <option value="shortanswer">ç°¡ç­”é¡Œ</option>
        </select><br><br>

        <button type="button" onclick="generateInstruction()">ç”ŸæˆæŒ‡ä»¤</button>
      </form>

      <!-- é¡¯ç¤ºç”Ÿæˆçš„æŒ‡ä»¤ -->
      <div id="generatedInstructionSection" style="display: none; margin-top: 20px;">
        <h3>ç”Ÿæˆçš„ AI æŒ‡ä»¤ï¼š</h3>
        <textarea id="generatedInstruction" rows="8" readonly></textarea><br><br>
        <button type="button" onclick="copyInstruction()">è¤‡è£½æŒ‡ä»¤</button>
      </div>

      <!-- é¸æ“‡ç”Ÿæˆå·¥å…· -->
      <div id="aiToolsSection" style="display: none; margin-top: 20px;">
        <h2>å°‡æŒ‡ä»¤è²¼å…¥ AI å·¥å…·ç”Ÿæˆé¡Œç›®ï¼š</h2>
        <button onclick="useAI('ChatGPT', 'https://chat.openai.com/')">è¤‡è£½æŒ‡ä»¤ä¸¦é–‹å•Ÿ ChatGPT</button>
        <button onclick="useAI('Grok3', 'https://grok3.com/')">è¤‡è£½æŒ‡ä»¤ä¸¦é–‹å•Ÿ Grok3</button> <!-- å‡è¨­ Grok3 ç¶²å€ -->
        <button onclick="useAI('Gemini', 'https://gemini.google.com/')">è¤‡è£½æŒ‡ä»¤ä¸¦é–‹å•Ÿ Gemini</button>
      </div>
    </section>

    <hr style="margin: 30px 0;"> <!-- åˆ†éš”ç·š -->

    <!-- æµ·é‡è²¼é¡Œå€ -->
    <section class="bulk-question-section">
      <h2>ğŸ”¹ è²¼ä¸Šç¾æœ‰é¡Œç›®å€ (åƒ…é™æ˜¯éé¡Œ)</h2>
      <small>â€» æ¯ä¸€è¡Œä¸€é¡Œï¼Œæ ¼å¼å¿…é ˆä»¥ (â—‹) æˆ– (Ã—) é–‹é ­ï¼Œä¾‹å¦‚ï¼š(â—‹) å¤ªé™½å¾æ±é‚Šå‡èµ·ã€‚</small><br><br>
      <textarea id="bulkQuestionInput" rows="15" placeholder="è«‹è²¼ä¸Šæ˜¯éé¡Œé¡Œç›®ï¼Œæ¯è¡Œåƒé€™æ¨£ï¼š(â—‹) 1+1=2"></textarea>

      <h2>ğŸ”¹ é¡Œç›®è¨­å®š (å„²å­˜ç”¨)</h2>

      <label for="questionDate">å‡ºé¡Œæ—¥æœŸï¼š</label>
      <input type="date" id="questionDate"><br><br>

      <label for="courseLevel">å­¸ç¨‹ï¼š</label>
      <select id="courseLevel">
        <option value="åœ‹å°ä¸­å¹´ç´š">åœ‹å°ä¸­å¹´ç´š</option>
        <option value="åœ‹å°é«˜å¹´ç´š">åœ‹å°é«˜å¹´ç´š</option>
        <option value="åœ‹ä¸­">åœ‹ä¸­</option>
        <option value="é«˜ä¸­">é«˜ä¸­</option>
      </select><br><br>

      <label for="subject">ç§‘ç›®ï¼š</label>
      <select id="subject">
        <option value="åœ‹èª">åœ‹èª</option>
        <option value="æ•¸å­¸">æ•¸å­¸</option>
        <option value="è‡ªç„¶">è‡ªç„¶</option>
        <option value="ç¤¾æœƒ">ç¤¾æœƒ</option>
        <option value="è‹±æ–‡">è‹±æ–‡</option>
        <option value="å…¶ä»–">å…¶ä»–</option>
      </select><br><br>

      <button id="saveBulkQuestionsBtn" onclick="saveBulkQuestions()">ğŸ’¾ å„²å­˜å…¨éƒ¨é¡Œç›®åˆ°Firebase</button>
    </section>

  </main>

  <!-- è²“è…³å°è¿”å›å‰ä¸€é  -->
  <footer>
    <button onclick="window.location.href='https://tangcat1125.github.io/catclassroom/task-system/task-center.html'">
      <img src="cat-paw-icon.png" alt="è¿”å›ä»»å‹™ä¸­å¿ƒ" width="30" style="vertical-align: middle; margin-right: 5px;"> è¿”å›ä»»å‹™ä¸­å¿ƒ
    </button>
  </footer>

  <!-- å°‡è…³æœ¬ç§»è‡³ body çµæŸå‰ -->
  <script>
    // --- AI æŒ‡ä»¤ç”Ÿæˆé‚è¼¯ ---

    // å°‡é¡Œå‹ä»£ç¢¼è½‰æ›ç‚ºä¸­æ–‡åç¨±
    function getQuestionTypeName(typeValue) {
        switch (typeValue) {
            case 'truefalse': return 'æ˜¯éé¡Œ';
            case 'choice': return 'é¸æ“‡é¡Œ (å–®é¸)';
            case 'multichoice': return 'è¤‡é¸é¡Œ';
            case 'shortanswer': return 'ç°¡ç­”é¡Œ';
            default: return 'æœªçŸ¥é¡Œå‹';
        }
    }

    // ç”Ÿæˆ AI æŒ‡ä»¤
    function generateInstruction() {
        const courseLevel = document.getElementById('wizardCourseLevel').value;
        const subject = document.getElementById('wizardSubject').value;
        const topic = document.getElementById('wizardTopic').value.trim(); // å»é™¤å‰å¾Œç©ºç™½
        const questionType = document.getElementById('promptType').value;
        const questionTypeName = getQuestionTypeName(questionType);

        if (!topic) {
            alert('è«‹è¼¸å…¥ã€Œå‡ºé¡Œä¸»é¡Œã€ï¼');
            document.getElementById('wizardTopic').focus();
            return; // å¦‚æœä¸»é¡Œç‚ºç©ºï¼Œåœæ­¢åŸ·è¡Œ
        }

        // çµ„è£ AI æŒ‡ä»¤
        let instruction = `è«‹ä½ æ‰®æ¼”ä¸€ä½å°ˆæ¥­çš„å‡ºé¡Œè€å¸«ã€‚\n`;
        instruction += `æ ¹æ“šä»¥ä¸‹æ¢ä»¶ï¼Œç‚ºæˆ‘å‡ºä¸€é“ã€Œ${questionTypeName}ã€ï¼š\n\n`;
        instruction += `å­¸ç¨‹ï¼š${courseLevel}\n`;
        instruction += `ç§‘ç›®ï¼š${subject}\n`;
        instruction += `ä¸»é¡Œï¼š${topic}\n\n`;
        instruction += `è¦æ±‚ï¼š\n`;
        instruction += `- é¡Œç›®å¿…é ˆèˆ‡ä¸»é¡Œ "${topic}" ç·Šå¯†ç›¸é—œã€‚\n`;
        instruction += `- é›£åº¦éœ€ç¬¦åˆ ${courseLevel} å­¸ç”Ÿçš„ç¨‹åº¦ã€‚\n`;
        instruction += `- é¡Œæ„æ¸…æ™°ï¼Œé¿å…æ¨¡æ£±å…©å¯ã€‚\n`;

        // æ ¹æ“šé¡Œå‹æ·»åŠ ç‰¹å®šè¦æ±‚
        switch (questionType) {
            case 'truefalse':
                instruction += `- è«‹ç›´æ¥çµ¦æˆ‘é¡Œç›®æ•˜è¿°ï¼Œä¸éœ€è¦åŒ…å« (â—‹) æˆ– (Ã—) æ¨™è¨˜ã€‚\n`;
                instruction += `- æœ€å¾Œè«‹æ˜ç¢ºæ¨™ç¤ºæ­£ç¢ºç­”æ¡ˆæ˜¯ã€Œæ˜¯ã€æˆ–ã€Œå¦ã€ï¼ˆæˆ– True/Falseï¼‰ã€‚\n`;
                break;
            case 'choice':
                instruction += `- è«‹æä¾› 4 å€‹é¸é … (A, B, C, D)ï¼Œå…¶ä¸­åªæœ‰ä¸€å€‹æ˜¯æ­£ç¢ºç­”æ¡ˆã€‚\n`;
                instruction += `- é¸é …å…§å®¹éœ€å…·å‚™ä¸€å®šçš„èª˜ç­”æ€§ã€‚\n`;
                instruction += `- æœ€å¾Œè«‹æ˜ç¢ºæ¨™ç¤ºæ­£ç¢ºç­”æ¡ˆçš„é¸é …ä»£è™Ÿ (ä¾‹å¦‚ï¼šç­”æ¡ˆï¼šC)ã€‚\n`;
                break;
            case 'multichoice':
                instruction += `- è«‹æä¾› 4-5 å€‹é¸é … (A, B, C, D, E)ï¼Œå…¶ä¸­å¯èƒ½æœ‰å¤šå€‹æ­£ç¢ºç­”æ¡ˆã€‚\n`;
                instruction += `- é¡Œç›®æ‡‰æ˜ç¢ºæŒ‡ç¤ºéœ€é¸å‡ºæ‰€æœ‰æ­£ç¢ºé¸é …ã€‚\n`;
                instruction += `- æœ€å¾Œè«‹æ˜ç¢ºæ¨™ç¤ºæ‰€æœ‰æ­£ç¢ºç­”æ¡ˆçš„é¸é …ä»£è™Ÿ (ä¾‹å¦‚ï¼šç­”æ¡ˆï¼šA, C, D)ã€‚\n`;
                break;
            case 'shortanswer':
                instruction += `- å•é¡Œæ‡‰å¼•å°å­¸ç”Ÿç°¡æ½”æ‰¼è¦åœ°å›ç­”æ ¸å¿ƒæ¦‚å¿µã€‚\n`;
                instruction += `- è«‹æä¾›åƒè€ƒç­”æ¡ˆæˆ–è©•åˆ†æ¨™æº–ã€‚\n`;
                break;
        }
         instruction += `\nè«‹é–‹å§‹å‡ºé¡Œï¼š`;

        // é¡¯ç¤ºç”Ÿæˆçš„æŒ‡ä»¤å€å¡Š
        document.getElementById('generatedInstruction').value = instruction;
        document.getElementById('generatedInstructionSection').style.display = 'block';
        document.getElementById('aiToolsSection').style.display = 'block'; // åŒæ™‚é¡¯ç¤º AI å·¥å…·æŒ‰éˆ•
    }

    // è¤‡è£½ç”Ÿæˆçš„æŒ‡ä»¤
    async function copyInstruction() {
        const textarea = document.getElementById('generatedInstruction');
        if (!textarea.value) {
            alert('è«‹å…ˆç”ŸæˆæŒ‡ä»¤ï¼');
            return false; // è¡¨ç¤ºè¤‡è£½å¤±æ•—
        }

        try {
            await navigator.clipboard.writeText(textarea.value);
            alert('æŒ‡ä»¤å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            return true; // è¡¨ç¤ºè¤‡è£½æˆåŠŸ
        } catch (err) {
            console.error('ç„¡æ³•è¤‡è£½æŒ‡ä»¤: ', err);
            // Fallback for older browsers or insecure contexts (like http)
            try {
                textarea.select();
                document.execCommand('copy');
                alert('æŒ‡ä»¤å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ (Fallback)ï¼');
                 return true;
            } catch (fallbackErr) {
                 alert('è¤‡è£½æŒ‡ä»¤å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ã€‚');
                 console.error('Fallback è¤‡è£½ä¹Ÿå¤±æ•—: ', fallbackErr);
                 return false;
            }
        }
    }

    // ä½¿ç”¨æŒ‡å®šçš„ AI å·¥å…·
    async function useAI(aiName, aiUrl) {
        const copied = await copyInstruction(); // å…ˆå˜—è©¦è¤‡è£½
        if (copied) {
            // å¦‚æœè¤‡è£½æˆåŠŸï¼Œé–‹å•Ÿæ–°è¦–çª—
            window.open(aiUrl, '_blank');
            // å¯ä»¥é¸æ“‡æ€§åœ°çµ¦äºˆæç¤º
            // alert(`æŒ‡ä»¤å·²è¤‡è£½ï¼Œæ­£åœ¨ç‚ºæ‚¨é–‹å•Ÿ ${aiName}... è«‹å°‡æŒ‡ä»¤è²¼å…¥ã€‚`);
        } else {
            // å¦‚æœè¤‡è£½å¤±æ•—ï¼Œæç¤ºä½¿ç”¨è€…
            alert(`ç„¡æ³•è‡ªå‹•è¤‡è£½æŒ‡ä»¤ã€‚è«‹å…ˆé»æ“Šã€Œç”ŸæˆæŒ‡ä»¤ã€ï¼Œç„¶å¾Œæ‰‹å‹•è¤‡è£½æŒ‡ä»¤æ–‡å­—ï¼Œå†æ‰“é–‹ ${aiName}ã€‚`);
            // ä»ç„¶å¯ä»¥é¸æ“‡æ‰“é–‹ç¶²å€ï¼Œè®“ä½¿ç”¨è€…æ‰‹å‹•è²¼ä¸Š
            // window.open(aiUrl, '_blank');
        }
    }

    // --- æµ·é‡è²¼é¡Œå€ç›¸é—œ (å‡è¨­ saveBulkQuestions åœ¨ task-editor.js ä¸­å®šç¾©) ---
    // é€™è£¡ä¸éœ€è¦é¡å¤–çš„ JSï¼Œé™¤éä½ è¦åœ¨é€™è£¡åšä¸€äº›å‰ç«¯é©—è­‰

  </script>

  <!-- è¼‰å…¥ Firebase å’Œä½ çš„æ¨¡çµ„è…³æœ¬ -->
  <!-- æ³¨æ„ï¼šç¢ºä¿ task-editor.js çš„è·¯å¾‘æ­£ç¢º -->
  <!-- å¦‚æœ task-editor.js ä¾è³´ Firebaseï¼Œè«‹ç¢ºä¿ Firebase SDK å·²åœ¨æ­¤ä¹‹å‰è¼‰å…¥ -->
  <!-- ä¾‹å¦‚ï¼š<script src="/path/to/firebase-app.js"></script> -->
  <!--      <script src="/path/to/firebase-firestore.js"></script> -->
  <script type="module" src="../task-system/task-editor.js"></script>

</body>
</html>
